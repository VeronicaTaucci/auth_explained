{"ast":null,"code":"import actionTypes from './actionTypes';\nimport axios from 'axios';\n\n/**\n ** Registering a user \n * {email, password}\n */\n\nexport const signUp = (formData, cb) => async dispatch => {\n  try {\n    //api call to our backend\n\n    let response = await axios.post('/register', formData);\n    //response.data.token\n    console.log(response); //token\n\n    //setting our token inside of global storage\n    dispatch({\n      type: actionTypes.AUTH_USER,\n      data: response.data.token\n    });\n    cb();\n\n    //store token in local storage\n\n    localStorage.setItem('token', response.data.token);\n  } catch (error) {\n    console.log(error);\n    dispatch({\n      type: actionTypes.ERROR,\n      data: error\n    });\n  }\n};\nexport const signIn = (formData, cb) => async dispatch => {\n  try {\n    let response = await axios.post('/login', formData);\n    console.log(\"logging in\", response.data.token);\n    dispatch({\n      type: actionTypes.AUTH_USER,\n      data: response.data.token\n    });\n    //invoke the callback function to navigate to a feature page\n    cb();\n    localStorage.setItem('token', response.data.token);\n  } catch (error) {\n    dispatch({\n      type: actionTypes.ERROR,\n      data: error\n    });\n  }\n};\nexport const signOut = cb => dispatch => {\n  // call to backend destroy token on backend\n  dispatch({\n    type: actionTypes.AUTH_USER,\n    data: \"\"\n  });\n  //clear local storage \n  localStorage.removeItem('token');\n  cb(); //navigate our user to some other page\n};\n\nexport const checkToken = () => async dispatch => {\n  if (localStorage.token) {\n    //api call\n    try {\n      let response = await axios.get('/protected', {\n        headers: {\n          'authorization': localStorage.token\n        }\n      });\n\n      //our token is valid \n\n      if (response.data.isValid) {\n        dispatch({\n          type: actionTypes.AUTH_USER,\n          data: localStorage.token\n        });\n      }\n    } catch (error) {\n      dispatch({\n        type: actionTypes.ERROR,\n        data: error\n      });\n    }\n  }\n};","map":{"version":3,"names":["actionTypes","axios","signUp","formData","cb","dispatch","response","post","console","log","type","AUTH_USER","data","token","localStorage","setItem","error","ERROR","signIn","signOut","removeItem","checkToken","get","headers","isValid"],"sources":["/Users/veronicataucci/Desktop/code_notes/auth/client/src/actions/index.js"],"sourcesContent":["\nimport actionTypes from './actionTypes';\nimport axios from 'axios'\n\n\n/**\n ** Registering a user \n * {email, password}\n */\n\nexport const signUp = (formData, cb) => async dispatch=>{\n\n    try{\n        //api call to our backend\n\n        let response = await axios.post('/register', formData)\n        //response.data.token\n        console.log(response);  //token\n\n        //setting our token inside of global storage\n        dispatch({\n            type: actionTypes.AUTH_USER, \n            data: response.data.token\n        })\n\n        cb()\n\n        //store token in local storage\n\n        localStorage.setItem('token', response.data.token)\n\n    }\n    catch(error){\n\n        console.log(error);\n\n        dispatch({\n            type: actionTypes.ERROR, \n            data: error\n        })\n    }\n\n    \n}\n\n\n\nexport const signIn = (formData, cb) => async dispatch =>{\n    try{\n        let response = await axios.post('/login', formData)\n        console.log(\"logging in\", response.data.token);\n        dispatch({\n            type: actionTypes.AUTH_USER, \n            data: response.data.token\n        })\n        //invoke the callback function to navigate to a feature page\n        cb()\n        localStorage.setItem('token', response.data.token)\n    }\n    catch(error){\n        dispatch({\n            type: actionTypes.ERROR, \n            data: error\n        })\n    }\n}\n\n\nexport const signOut = (cb) => dispatch =>{\n    // call to backend destroy token on backend\n    dispatch({\n        type: actionTypes.AUTH_USER, \n        data: \"\"\n    })\n    //clear local storage \n    localStorage.removeItem('token')\n    cb();  //navigate our user to some other page\n\n}\n\n\n\nexport const checkToken = () => async dispatch =>{\n    if(localStorage.token){\n        //api call\n        try{\n            let response = await axios.get('/protected', {\n\n                headers: {\n                    'authorization': localStorage.token\n                }\n            })\n\n            //our token is valid \n\n            if(response.data.isValid){\n                dispatch({\n                    type:  actionTypes.AUTH_USER, \n                    data: localStorage.token\n                })\n            }\n        }\n        catch(error){\n            dispatch({\n                type: actionTypes.ERROR, \n                data: error\n            })\n        }\n    }\n\n}\n"],"mappings":"AACA,OAAOA,WAAW,MAAM,eAAe;AACvC,OAAOC,KAAK,MAAM,OAAO;;AAGzB;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,MAAM,GAAGA,CAACC,QAAQ,EAAEC,EAAE,KAAK,MAAMC,QAAQ,IAAE;EAEpD,IAAG;IACC;;IAEA,IAAIC,QAAQ,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,WAAW,EAAEJ,QAAQ,CAAC;IACtD;IACAK,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC,CAAC,CAAE;;IAExB;IACAD,QAAQ,CAAC;MACLK,IAAI,EAAEV,WAAW,CAACW,SAAS;MAC3BC,IAAI,EAAEN,QAAQ,CAACM,IAAI,CAACC;IACxB,CAAC,CAAC;IAEFT,EAAE,EAAE;;IAEJ;;IAEAU,YAAY,CAACC,OAAO,CAAC,OAAO,EAAET,QAAQ,CAACM,IAAI,CAACC,KAAK,CAAC;EAEtD,CAAC,CACD,OAAMG,KAAK,EAAC;IAERR,OAAO,CAACC,GAAG,CAACO,KAAK,CAAC;IAElBX,QAAQ,CAAC;MACLK,IAAI,EAAEV,WAAW,CAACiB,KAAK;MACvBL,IAAI,EAAEI;IACV,CAAC,CAAC;EACN;AAGJ,CAAC;AAID,OAAO,MAAME,MAAM,GAAGA,CAACf,QAAQ,EAAEC,EAAE,KAAK,MAAMC,QAAQ,IAAG;EACrD,IAAG;IACC,IAAIC,QAAQ,GAAG,MAAML,KAAK,CAACM,IAAI,CAAC,QAAQ,EAAEJ,QAAQ,CAAC;IACnDK,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEH,QAAQ,CAACM,IAAI,CAACC,KAAK,CAAC;IAC9CR,QAAQ,CAAC;MACLK,IAAI,EAAEV,WAAW,CAACW,SAAS;MAC3BC,IAAI,EAAEN,QAAQ,CAACM,IAAI,CAACC;IACxB,CAAC,CAAC;IACF;IACAT,EAAE,EAAE;IACJU,YAAY,CAACC,OAAO,CAAC,OAAO,EAAET,QAAQ,CAACM,IAAI,CAACC,KAAK,CAAC;EACtD,CAAC,CACD,OAAMG,KAAK,EAAC;IACRX,QAAQ,CAAC;MACLK,IAAI,EAAEV,WAAW,CAACiB,KAAK;MACvBL,IAAI,EAAEI;IACV,CAAC,CAAC;EACN;AACJ,CAAC;AAGD,OAAO,MAAMG,OAAO,GAAIf,EAAE,IAAKC,QAAQ,IAAG;EACtC;EACAA,QAAQ,CAAC;IACLK,IAAI,EAAEV,WAAW,CAACW,SAAS;IAC3BC,IAAI,EAAE;EACV,CAAC,CAAC;EACF;EACAE,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;EAChChB,EAAE,EAAE,CAAC,CAAE;AAEX,CAAC;;AAID,OAAO,MAAMiB,UAAU,GAAGA,CAAA,KAAM,MAAMhB,QAAQ,IAAG;EAC7C,IAAGS,YAAY,CAACD,KAAK,EAAC;IAClB;IACA,IAAG;MACC,IAAIP,QAAQ,GAAG,MAAML,KAAK,CAACqB,GAAG,CAAC,YAAY,EAAE;QAEzCC,OAAO,EAAE;UACL,eAAe,EAAET,YAAY,CAACD;QAClC;MACJ,CAAC,CAAC;;MAEF;;MAEA,IAAGP,QAAQ,CAACM,IAAI,CAACY,OAAO,EAAC;QACrBnB,QAAQ,CAAC;UACLK,IAAI,EAAGV,WAAW,CAACW,SAAS;UAC5BC,IAAI,EAAEE,YAAY,CAACD;QACvB,CAAC,CAAC;MACN;IACJ,CAAC,CACD,OAAMG,KAAK,EAAC;MACRX,QAAQ,CAAC;QACLK,IAAI,EAAEV,WAAW,CAACiB,KAAK;QACvBL,IAAI,EAAEI;MACV,CAAC,CAAC;IACN;EACJ;AAEJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}